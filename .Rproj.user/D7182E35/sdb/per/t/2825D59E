{
    "contents" : "#-------------------------------------------------------------------------------------------------------------\n#Psychophysiological Methods and Analysis: Module 2: Heart Rate Variability\n#-------------------------------------------------------------------------------------------------------------\n\n#-------------------------------------------------------------------------------------------------------------\nsetwd(\"C:/Users/Niall/Dropbox/NIALL1/MET/ppmc\");\nhrv <- read.csv(\"ISP_HR_partialdata_long.csv\")\n#-------------------------------------------------------------------------------------------------------------\nlibrary(lme4)\nlibrary(brms)\nlibrary(car)\n\n#Linear model with fixed intercept and slope\nrsaout0<- lm(RSA ~ Condition*phase, data = hrv)\nsummary(rsaout0)\nAnova(rsaout0, type=\"3\")\n\n#Model with random intercept and fixed slope\nrsaout1<- lmer(RSA ~ Condition*phase + (1 | subj), data = hrv)\nsummary(rsaout1)\nAnova(rsaout1, type=\"3\")\n\n#Model with random intercept and random slope\nrsaout2<- lmer(RSA ~ Condition*phase + (1 + phase | subj), data = hrv)\nsummary(rsaout2)\nAnova(rsaout2, type=\"3\")\n\n\n#Linear model with fixed intercept and slope using Bayesian estimation\nrsabrm0<- brm(RSA ~ Condition*phase, data = hrv)\nsummary(rsabrm0)\nplot(rsabrm0)\n\n\n\n#-------------------------------------------------------------------------------------------------------------\n#Order the hrv dataset by the size of the change in RSA between time 5 and 6\n\n#Create variable that is the difference in RSA between time 5 and 6\n# using subset function\n\n# First, subset RSA for time=5 (1 dataline per subj)\ntime5 <- subset(hrv, time==5, select=c(subj, time, RSA))\nnames(time5) <- c(\"subj\", \"time\", \"RSA5\")\n\n#Next, subset time=5\ntime6 <- subset(hrv, time == 6, select=c(subj, time, RSA))\nnames(time6) <- c(\"vsubj\", \"vtime\", \"RSA6\")\n\n#Bind the datasets by column, so there is still just 1 dataline per subj\ntime56 <- cbind(time5, time6)\ntime56$difRSA <- time56$RSA6 - time56$RSA5\n\n#Merge and order by RSA difference between time 5 and 6 \nhrv2 <- merge(hrv1, time56, by = \"subj\")\nordhrv2 <- hrv2[order(hrv2$difRSA), ]\nordtime56 <- time56[order(time56$difRSA), ]\n\n\n#-------------------------------------------------------------------------------------------------------------\n#Panel plots, ordered by RSA change between time 5 at time 6\n#-------------------------------------------------------------------------------------------------------------\n\npdf(file=\"hrv-drop-ordered-panel-time-course.pdf\", width=14, height=28)\npar(mfrow=c(11,7))\nfor (i in ordtime56$subj) {\n  plot(hrv1$time[hrv1$subj==i], hrv1$RSA[hrv1$subj==i],  ylab=\"HR Variability\", xlab=\"Time\",\n       type=\"l\", ylim=c(0,10), xlim=c(0, 13)) \n}\ndev.off()\n\n\n#-------------------------------------------------------------------------------------------------------------\n#Panel Plots HRV actual and HRV predicted vs. Time for subjects ordered by time 6 drop\n#-------------------------------------------------------------------------------------------------------------\npdf(file=\"hrv-panel-HRV-pred-vs-time-for-time6-drop.pdf\", width=14, height=28)\npar(mfrow=c(11,7))\nfor (i in ordtime56$subj) {\n  plot(hrv$time[hrv$subj==i], hrv$RSA[hrv$subj==i],  ylab=\"HR Variability\", xlab=\"Time\",\n       type=\"o\", pch=19, col=\"blue\", ylim=c(.8,10), xlim=c(0, 13))\n  points(hrv$time[hrv$subj==i], predict(rsaout2)[hrv$subj==i], pch=\"-\", cex=3, col=\"red\")\n  abline(v=c(5, 10))\n  \n}\ndev.off()\n\n",
    "created" : 1456438639236.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "193085481",
    "id" : "2825D59E",
    "lastKnownWriteTime" : 1456438595,
    "path" : "~/KZNB/hrv.R",
    "project_path" : "hrv.R",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}