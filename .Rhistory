rcc$prev.v <- as.vector(rowMeans(rcc$prev.matrix, na.rm=T))
rcc$prev.c <- scale(rcc$prev.v, center=T, scale=F)
rcc$rfpredom <- rcc$prom.v - rcc$prev.v
rcc$rfpredom.c <- center(rcc$rfpredom)
rcc$rfpredomave <- (rcc$prom.v + rcc$prev.v)/2
rcc$rfpredomave.c <- center(rcc$rfpredomave)
rcc$pprom.c[rcc$dyad==rcc$dyad & rcc$partner == "A"] <-  rcc$prom.c[rcc$partner == "B"]
rcc$pprom.c[rcc$dyad==rcc$dyad & rcc$partner == "B"] <-  rcc$prom.c[rcc$partner == "A"]
rcc$pprev.c[rcc$dyad==rcc$dyad & rcc$partner == "A"] <-  rcc$prev.c[rcc$partner == "B"]
rcc$pprev.c[rcc$dyad==rcc$dyad & rcc$partner == "B"] <-  rcc$prev.c[rcc$partner == "A"]
rcc$prfpredom.c[rcc$dyad==rcc$dyad & rcc$partner == "A"] <-  rcc$rfpredom.c[rcc$partner == "B"]
rcc$prfpredom.c[rcc$dyad==rcc$dyad & rcc$partner == "B"] <-  rcc$rfpredom.c[rcc$partner == "A"]
rcc$prfpredomave.c[rcc$dyad==rcc$dyad & rcc$partner == "A"] <-  rcc$rfpredomave.c[rcc$partner == "B"]
rcc$prfpredomave.c[rcc$dyad==rcc$dyad & rcc$partner == "B"] <-  rcc$rfpredomave.c[rcc$partner == "A"]
rcc$prfpredom[rcc$dyad==rcc$dyad & rcc$partner == "A"] <-  rcc$rfpredom[rcc$partner == "B"]
rcc$prfpredom[rcc$dyad==rcc$dyad & rcc$partner == "B"] <-  rcc$rfpredom[rcc$partner == "A"]
rcc$prfpredomave[rcc$dyad==rcc$dyad & rcc$partner == "A"] <-  rcc$rfpredomave[rcc$partner == "B"]
rcc$prfpredomave[rcc$dyad==rcc$dyad & rcc$partner == "B"] <-  rcc$rfpredomave[rcc$partner == "A"]
######## Reg Mode #########
rcc$rmq2r <- 7-rcc$rmq2
rcc$rmq10r <- 7-rcc$rmq10
rcc$rmq27r <- 7-rcc$rmq27
rcc$rmq13r <- 7-rcc$rmq13
rcc$rmq24r <- 7-rcc$rmq24
rcc$loc.matrix <- cbind(rcc$rmq1,rcc$rmq3, rcc$rmq4, rcc$rmq5, rcc$rmq8, rcc$rmq13r, rcc$rmq16, rcc$rmq21, rcc$rmq24r, rcc$rmq25, rcc$rmq28, rcc$rmq29)
rcc$loc.v <- as.vector(rowMeans(rcc$loc.matrix, na.rm=T))
rcc$loc.c <- scale (rcc$loc.v, center=T, scale=F)
rcc$ass.matrix <- cbind(rcc$rmq2r, rcc$rmq6, rcc$rmq7, rcc$rmq9, rcc$rmq10r, rcc$rmq11, rcc$rmq15, rcc$rmq19, rcc$rmq20, rcc$rmq22, rcc$rmq27r, rcc$rmq30)
rcc$ass.v <- as.vector(rowMeans(rcc$ass.matrix, na.rm =T))
rcc$ass.c <- scale (rcc$ass.v, center=T, scale=F)
rcc$locXass <- rcc$loc.c*rcc$ass.c
psych::alpha(as.data.frame(rcc$loc.matrix))
psych::alpha(as.data.frame(rcc$ass.matrix))
rcc$predom <- rcc$loc.v - rcc$ass.v
rcc$predom.c <- scale(rcc$predom, center=T, scale=F)
rcc$predom <- as.vector(rcc$predom)
summarize(rcc$predom)
rcc$predomave <- (rcc$loc.v+rcc$ass.v)/2
rcc$predomave.c <- center(rcc$predomave)
rcc$ploc.c[rcc$dyad==rcc$dyad & rcc$partner == "A"] <-  rcc$loc.c[rcc$partner == "B"]
rcc$ploc.c[rcc$dyad==rcc$dyad & rcc$partner == "B"] <-  rcc$loc.c[rcc$partner == "A"]
rcc$pass.c[rcc$dyad==rcc$dyad & rcc$partner == "A"] <-  rcc$ass.c[rcc$partner == "B"]
rcc$pass.c[rcc$dyad==rcc$dyad & rcc$partner == "B"] <-  rcc$ass.c[rcc$partner == "A"]
##### Cap #######
###### Capitalization #######
# active/constructive;
rcc$actconstruct.m <- cbind(rcc$prca1, rcc$prca5, rcc$prca9, rcc$prca13)
rcc$actconstruct.v <- rowMeans(rcc$actconstruct.m, na.rm=T)
rcc$actconstruct.r <- 8 - rcc$actconstruct.v
rcc$actconstruct.c <- center(rcc$actconstruct.v )
#active/destructive;
rcc$actdestruct.m <- cbind(rcc$prca2, rcc$prca6, rcc$prca10, rcc$prca14)
rcc$actdestruct.v <- rowMeans(rcc$actdestruct.m, na.rm=T)
rcc$actdestruct.r <- 8 - rcc$actdestruct.v
#passive/constructive;
rcc$pasconstruct.m <- cbind(rcc$prca3, rcc$prca7, rcc$prca11, rcc$prca15)
rcc$pasconstruct.v <- rowMeans(rcc$pasconstruct.m, na.rm=T)
rcc$pasconstruct.r <- 8 - rcc$pasconstruct.v
#passive/destructive;
rcc$pasdestruct.m <- cbind(rcc$prca4, rcc$prca8, rcc$prca12, rcc$prca16);
rcc$pasdestruct.v <- rowMeans(rcc$pasdestruct.m, na.rm=T)
rcc$pasdestruct.r <- 8 - rcc$pasdestruct.v
#total
rcc$captotal.m <- cbind(rcc$actconstruct, rcc$actdestruct.r, rcc$pasconstruct.r, rcc$pasdestruct.r)
rcc$captotal.v <- rowMeans(rcc$captotal.m, na.rm=T)
#total other than active constructive
rcc$capother.m <- cbind(rcc$actdestruct.r, rcc$pasconstruct.v, rcc$pasdestruct.r)
rcc$capother.v <- rowMeans(rcc$capother.m , na.rm=T)
rcc$capother.c <- center(rcc$capother.v)
rcc$capother2.m <- cbind(rcc$actdestruct.v, rcc$pasdestruct.v, rcc$pasconstruct.v)
rcc$capother2.v <- rowMeans(rcc$capother2.m , na.rm=T)
rcc$capother2.c <- center(rcc$capother2.v)
rcc$capother2.v  <- as.numeric(rcc$capother2.v )
rcc$actconstruct.v <- as.numeric(rcc$actconstruct.v)
rcc$captotal2.v <- rcc$actconstruct.v - rcc$capother2.v
rcc$capother3.m <- cbind(rcc$actconstruct.v, rcc$pasconstruct.v, rcc$pasdestruct.r)
rcc$capother3.v <- rowMeans(rcc$capother3.m , na.rm=T)
rcc$capother3.c <- center(rcc$capother3.v)
rcc$capother4.m <- cbind(rcc$actconstruct.v, rcc$pasconstruct.v, rcc$pasdestruct.r, rcc$actdestruct.r)
rcc$capother4.v <- rowMeans(rcc$capother4.m , na.rm=T)
######
summary(glmer(exercise ~ ploc.c * pass.c * loc.c * ass.c + (1 | dyad), data = subset(rcc, exercise==1 | exercise==0),
family = "binomial"))
rccsleep <- subset(rcc, sleepqual=!"9:00")
rccsleep$sleepqual <- as.numeric(rccsleep$sleepqual)
summary(lmer(sleepqual ~ capother4.v + (1 | dyad), data = rccsleep))
summary(lmer(sleepqual ~ actconstruct.v + capother.v + sleeplength + (1 | dyad), data = rccsleep))
sleepmod <- (lmer(sleepqual ~ actconstruct.c * capother2.c *gender  + sleeplength + (1 | dyad), data = rccsleep))
summary(sleepmod)
summary(modelprovwc.brms)
nsfvid$pmts4_2c.r
nsfvid$T_SEX
nsfvid$glsex
nsfvid$code
nsfvid$smps1_7a
nsfvid$pmps1_7a
head(nsfvid)
nsfvid$smps1_5a
nsfvid$coderesp.m <- with(nsfvid, cbind(smps1_5a,smps1_5b, smps1_5c,
smps2_5a,smps2_5b, smps2_5c,
smps3_5a,smps3_5b, smps3_5c,
smps4_5a,smps4_5b, smps4_5c))
nsfvid$coderesp.v <- rowMeans(nsfvid$coderesp.m, na.rm=T)
summary(lmer(scale(coderesp.v) ~ scale(t5.loc.c) + scale(t5.ass.c) + (1 | code), data = nsfvid))
nsfvid$coderesp.m <- with(nsfvid, cbind(
smps2_5a,smps2_5b, smps2_5c,
smps3_5a,smps3_5b, smps3_5c,
smps4_5a,smps4_5b, smps4_5c))
nsfvid$coderesp.v <- rowMeans(nsfvid$coderesp.m, na.rm=T)
summary(lmer(scale(coderesp.v) ~ scale(t5.loc.c) + scale(t5.ass.c) + (1 | code), data = nsfvid))
nsfvid$coderesp.m <- with(nsfvid, cbind(smpg2_4,  smpg2_5, smpg2_6))
nsfvid$coderesp.v <- rowMeans(nsfvid$coderesp.m, na.rm=T)
summary(lmer(scale(coderesp.v) ~ scale(t5.loc.c) + scale(t5.ass.c) + (1 | code), data = nsfvid))
cor.prob <- function (X, dfr = nrow(X) - 2) {
R <- cor(X, use="pairwise.complete.obs")
above <- row(R) < col(R)
r2 <- R[above]^2
Fstat <- r2 * dfr/(1 - r2)
R[above] <- 1 - pf(Fstat, 1, dfr)
R[row(R) == col(R)] <- NA
R
}
flattenSquareMatrix <- function(m) {
if( (class(m) != "matrix") | (nrow(m) != ncol(m))) stop("Must be a square matrix.")
if(!identical(rownames(m), colnames(m))) stop("Row and column names must be equal.")
ut <- upper.tri(m)
data.frame(i = rownames(m)[row(m)[ut]],
j = rownames(m)[col(m)[ut]],
cor=t(m)[ut],
p=m[ut])
}
fetzer$moveindex.v
fetzervars <- cbind(fetzer$loc.v, fetzer$ass.v, fetzer$receptive, fetzer$moveindex.v, fetzer$mpresp)
colnames(fetzervars) <- c("loc.v", "ass.v", "receptive", "moveindex.v", "mpresp")
flattenSquareMatrix(cor.prob(fetzervars))
summary(modelprovwc.brms)
summary(mod1)
modelprovwc.brms2 <- brm(b.rsa.wc ~ 0 + pa + pb + pa:rsa.lag + pb:rsa.lag + pa:suprole2 + pb:suprole2 +
+ pa:b.rsa.lag + pb:b.rsa.lag + pa:rsa.lag:suprole2 + pb:rsa.lag:suprole2 +
pa:b.rsa.lag:suprole2 + pb:b.rsa.lag:suprole2 +
(0 + pa + pb + pa:suprole2 + pb:suprole2 + pa:rsa.lag + pb:rsa.lag | dyad), data = aoc2, cores = 4,
chains = 1, iter =500, autocor = cor_ar(~time|id))
summary(modelprovwc.brms2)
setwd("/Users/zeekatherine/Desktop/R Files/RCC_Data")
aoc <- read.csv("rcc_physio_AOC_LONG_170223.csv")
#aoc1b <- as.data.frame(cbind(aoc1$dyad, aoc1$partner, aoc1$time, aoc1$rsa))
#colnames(aoc1b) <- c("dyad", "partner", "time", "rsa")
#aoc1c <- aoc1[order(-aoc1$rsa),]
#aoc <- subset(aoc1, rsa < 10 & b.rsa < 10)
mean.na <- function (x) {
out <- mean(x, na.rm=T)
out
}
library(dplyr)
library(car)
library(brms)
library(ggplot2)
library(ggthemes)
library(lme4)
library(lmerTest)
library(brms)
aoc$phase <- (car::recode(aoc$time, "1:10 = 'Baseline'; 11:20 = 'GoalDisc'; 21:30 = 'Sup_A'; 31:40 = 'Sup_B'"))
aoc$id <- (paste(aoc$dyad, aoc$partner, sep="."))
aoc$suprole <- aoc$phase
aoc$suprole[aoc$phase=="Sup_A" & aoc$firstsharer=="A" & aoc$partner=="A"] <- "receive"
aoc$suprole[aoc$phase=="Sup_A" & aoc$firstsharer=="B" & aoc$partner=="B"] <- "receive"
aoc$suprole[aoc$phase=="Sup_A" & aoc$firstsharer=="A" & aoc$partner=="B"] <- "provide"
aoc$suprole[aoc$phase=="Sup_A" & aoc$firstsharer=="B" & aoc$partner=="A"] <- "provide"
aoc$suprole[aoc$phase=="Sup_B" & aoc$firstsharer=="A" & aoc$partner=="A"] <- "provide"
aoc$suprole[aoc$phase=="Sup_B" & aoc$firstsharer=="B" & aoc$partner=="B"] <- "provide"
aoc$suprole[aoc$phase=="Sup_B" & aoc$firstsharer=="A" & aoc$partner=="B"] <- "receive"
aoc$suprole[aoc$phase=="Sup_B" & aoc$firstsharer=="B" & aoc$partner=="A"] <- "receive"
aoc$suprole <- as.factor(aoc$suprole)
aoc <- within(aoc, suprole2 <- relevel(suprole, ref = "provide")) # reference group = female providing, male receiving
aoc$suprole2 <- as.factor(aoc$suprole2)
aoc<- within(aoc, {base.mean = ave(rsa, dyad, partner, phase[aoc$phase=="Baseline"], FUN = mean.na)})
aoc<- within(aoc, {b.base.mean = ave(b.rsa, dyad, partner, phase[aoc$phase=="Baseline"], FUN = mean.na)})
aoc$rsa.basec <- aoc$rsa - aoc$base.mean
aoc$b.rsa.basec <- aoc$b.rsa - aoc$b.base.mean
aoc$pa <- ifelse(aoc$partner=="A", 1, 0)
aoc$pb <- ifelse(aoc$partner=="B", 1, 0)
aoc<- within(aoc, {rsa.mean = ave(rsa, dyad, partner, FUN = mean.na)})
aoc$rsa.wc <- aoc$rsa - aoc$rsa.mean
aoc <- within(aoc, {rsa.lag = ave(rsa.wc, dyad, partner, FUN = dplyr::lag)})
aoc<- within(aoc, {b.rsa.mean = ave(b.rsa, dyad, partner, FUN = mean.na)})
aoc$b.rsa.wc <- aoc$b.rsa - aoc$b.rsa.mean
aoc <- within(aoc, {b.rsa.lag = ave(b.rsa.wc, dyad, partner, FUN = dplyr::lag)})
aoc<- within(aoc, {ibi.mean = ave(ibi, dyad, partner, FUN = mean.na)})
aoc$ibi.wc <- aoc$ibi - aoc$ibi.mean
aoc <- within(aoc, {ibi.lag = ave(ibi.wc, dyad, partner, suprole2, FUN = dplyr::lag)})
aoc<- within(aoc, {b.ibi.mean = ave(b.ibi, dyad, partner, FUN = mean.na)})
aoc$b.ibi.wc <- aoc$b.ibi - aoc$b.ibi.mean
aoc <- within(aoc, {b.ibi.lag = ave(b.ibi.wc, dyad, partner, suprole2, FUN = dplyr::lag)})
aoc<- within(aoc, {ibi.mean = ave(ibi, dyad, partner, FUN = mean.na)})
aoc$ibi.wc <- aoc$ibi - aoc$ibi.mean
aoc <- within(aoc, {ibi.lag = ave(ibi.wc, dyad, partner, suprole2, FUN = dplyr::lag)})
aoc<- within(aoc, {b.ibi.mean = ave(b.ibi, dyad, partner, FUN = mean.na)})
aoc$b.ibi.wc <- aoc$b.ibi - aoc$b.ibi.mean
aoc <- within(aoc, {b.ibi.lag = ave(b.ibi.wc, dyad, partner, suprole2, FUN = dplyr::lag)})
aoc<- within(aoc, {b.hr.mean = ave(b.hr, dyad, partner, FUN = mean.na)})
aoc$b.hr.wc <- aoc$b.hr - aoc$b.hr.mean
aoc <- within(aoc, {b.hr.lag = ave(b.hr.wc, dyad, partner, suprole2, FUN = dplyr::lag)})
aoc<- within(aoc, {hr.mean = ave(hr, dyad, partner, FUN = mean.na)})
aoc$hr.wc <- aoc$hr - aoc$hr.mean
aoc <- within(aoc, {hr.lag = ave(hr.wc, dyad, partner, suprole2, FUN = dplyr::lag)})
aoc<- within(aoc, {ibi.phasemean = ave(ibi, dyad, partner, phase, FUN = mean.na)})
#aoc$ibi.basemean <- ifelse(aoc$phase=="GoalDisc", aoc$ibi.phasemean[aoc$time==1], aoc$ibi.phasemean[aoc$time==1])
aoc <- within(aoc, {b.hr.lag = ave(b.hr.wc, dyad, partner, suprole2, FUN = dplyr::lag)})
aoc <- within(aoc, {rsa.basec.lag = ave(rsa.basec, dyad, partner, suprole2, FUN = dplyr::lag)})
aoc <- within(aoc, {b.rsa.basec.lag = ave(b.rsa.basec, dyad, partner, suprole2, FUN = dplyr::lag)})
#View(cbind(aoc$dyad, aoc$partner, aoc$phase, aoc$ibi.phasemean, aoc$ibi.basemean))
aoc$prov <- ifelse(aoc$suprole=="provide", 0, 1)
aoc2 <- subset(aoc, suprole =="provide" | suprole=="receive")
aoc2 <- subset(aoc, suprole =="provide" | suprole=="receive")
modelprovwc.brms2 <- brm(b.rsa.wc ~ 0 + pa + pb + pa:rsa.lag + pb:rsa.lag + pa:suprole2 + pb:suprole2 +
+ pa:b.rsa.lag + pb:b.rsa.lag + pa:rsa.lag:suprole2 + pb:rsa.lag:suprole2 +
pa:b.rsa.lag:suprole2 + pb:b.rsa.lag:suprole2 +
(0 + pa + pb + pa:suprole2 + pb:suprole2 + pa:rsa.lag + pb:rsa.lag | dyad), data = aoc2, cores = 4,
chains = 1, iter =500, autocor = cor_ar(~time|id))
summary(modelprovwc.brms2)
prior <- get_prior(modelprovwc.brms2)
prior <- get_prior(modelprovwc.brms2)
prior <- get_prior(b.rsa.wc ~ 0 + pa + pb + pa:rsa.lag + pb:rsa.lag + pa:suprole2 + pb:suprole2 +
+ pa:b.rsa.lag + pb:b.rsa.lag + pa:rsa.lag:suprole2 + pb:rsa.lag:suprole2 +
pa:b.rsa.lag:suprole2 + pb:b.rsa.lag:suprole2 +
(0 + pa + pb + pa:suprole2 + pb:suprole2 + pa:rsa.lag + pb:rsa.lag | dyad), data = aoc2, cores = 4,
chains = 1, iter =500, autocor = cor_ar(~time|id))
prior <- get_prior(b.rsa.wc ~ 0 + pa + pb + pa:rsa.lag + pb:rsa.lag + pa:suprole2 + pb:suprole2 +
+ pa:b.rsa.lag + pb:b.rsa.lag + pa:rsa.lag:suprole2 + pb:rsa.lag:suprole2 +
pa:b.rsa.lag:suprole2 + pb:b.rsa.lag:suprole2 +
(0 + pa + pb + pa:suprole2 + pb:suprole2 + pa:rsa.lag + pb:rsa.lag | dyad), data = aoc2, autocor = cor_ar(~time|id))
prior
prior
prior$prior[1] <- "normal(0,10)"
make_stancode(b.rsa.wc ~ 0 + pa + pb + pa:rsa.lag + pb:rsa.lag + pa:suprole2 + pb:suprole2 +
+ pa:b.rsa.lag + pb:b.rsa.lag + pa:rsa.lag:suprole2 + pb:rsa.lag:suprole2 +
pa:b.rsa.lag:suprole2 + pb:b.rsa.lag:suprole2 +
(0 + pa + pb + pa:suprole2 + pb:suprole2 + pa:rsa.lag + pb:rsa.lag | dyad), data = aoc2, autocor = cor_ar(~time|id),
prior=prior)
setwd("/Users/zeekatherine/Desktop/R Files/RCC_Data")
aoc <- read.csv("rcc_physio_AOC_LONG_170223.csv")
#aoc1b <- as.data.frame(cbind(aoc1$dyad, aoc1$partner, aoc1$time, aoc1$rsa))
#colnames(aoc1b) <- c("dyad", "partner", "time", "rsa")
#aoc1c <- aoc1[order(-aoc1$rsa),]
#aoc <- subset(aoc1, rsa < 10 & b.rsa < 10)
mean.na <- function (x) {
out <- mean(x, na.rm=T)
out
}
library(dplyr)
library(car)
library(brms)
library(ggplot2)
library(ggthemes)
library(lme4)
library(lmerTest)
library(brms)
aoc$phase <- (car::recode(aoc$time, "1:10 = 'Baseline'; 11:20 = 'GoalDisc'; 21:30 = 'Sup_A'; 31:40 = 'Sup_B'"))
aoc$id <- (paste(aoc$dyad, aoc$partner, sep="."))
aoc$suprole <- aoc$phase
aoc$suprole[aoc$phase=="Sup_A" & aoc$firstsharer=="A" & aoc$partner=="A"] <- "receive"
aoc$suprole[aoc$phase=="Sup_A" & aoc$firstsharer=="B" & aoc$partner=="B"] <- "receive"
aoc$suprole[aoc$phase=="Sup_A" & aoc$firstsharer=="A" & aoc$partner=="B"] <- "provide"
aoc$suprole[aoc$phase=="Sup_A" & aoc$firstsharer=="B" & aoc$partner=="A"] <- "provide"
aoc$suprole[aoc$phase=="Sup_B" & aoc$firstsharer=="A" & aoc$partner=="A"] <- "provide"
aoc$suprole[aoc$phase=="Sup_B" & aoc$firstsharer=="B" & aoc$partner=="B"] <- "provide"
aoc$suprole[aoc$phase=="Sup_B" & aoc$firstsharer=="A" & aoc$partner=="B"] <- "receive"
aoc$suprole[aoc$phase=="Sup_B" & aoc$firstsharer=="B" & aoc$partner=="A"] <- "receive"
aoc$suprole <- as.factor(aoc$suprole)
aoc <- within(aoc, suprole2 <- relevel(suprole, ref = "provide")) # reference group = female providing, male receiving
aoc$suprole2 <- as.factor(aoc$suprole2)
aoc<- within(aoc, {base.mean = ave(rsa, dyad, partner, phase[aoc$phase=="Baseline"], FUN = mean.na)})
aoc<- within(aoc, {b.base.mean = ave(b.rsa, dyad, partner, phase[aoc$phase=="Baseline"], FUN = mean.na)})
aoc$rsa.basec <- aoc$rsa - aoc$base.mean
aoc$b.rsa.basec <- aoc$b.rsa - aoc$b.base.mean
aoc$pa <- ifelse(aoc$partner=="A", 1, 0)
aoc$pb <- ifelse(aoc$partner=="B", 1, 0)
aoc<- within(aoc, {rsa.mean = ave(rsa, dyad, partner, FUN = mean.na)})
aoc$rsa.wc <- aoc$rsa - aoc$rsa.mean
aoc <- within(aoc, {rsa.lag = ave(rsa.wc, dyad, partner, FUN = dplyr::lag)})
aoc<- within(aoc, {b.rsa.mean = ave(b.rsa, dyad, partner, FUN = mean.na)})
aoc$b.rsa.wc <- aoc$b.rsa - aoc$b.rsa.mean
aoc <- within(aoc, {b.rsa.lag = ave(b.rsa.wc, dyad, partner, FUN = dplyr::lag)})
aoc<- within(aoc, {ibi.mean = ave(ibi, dyad, partner, FUN = mean.na)})
aoc$ibi.wc <- aoc$ibi - aoc$ibi.mean
aoc <- within(aoc, {ibi.lag = ave(ibi.wc, dyad, partner, suprole2, FUN = dplyr::lag)})
aoc<- within(aoc, {b.ibi.mean = ave(b.ibi, dyad, partner, FUN = mean.na)})
aoc$b.ibi.wc <- aoc$b.ibi - aoc$b.ibi.mean
aoc <- within(aoc, {b.ibi.lag = ave(b.ibi.wc, dyad, partner, suprole2, FUN = dplyr::lag)})
aoc<- within(aoc, {ibi.mean = ave(ibi, dyad, partner, FUN = mean.na)})
aoc$ibi.wc <- aoc$ibi - aoc$ibi.mean
aoc <- within(aoc, {ibi.lag = ave(ibi.wc, dyad, partner, suprole2, FUN = dplyr::lag)})
aoc<- within(aoc, {b.ibi.mean = ave(b.ibi, dyad, partner, FUN = mean.na)})
aoc$b.ibi.wc <- aoc$b.ibi - aoc$b.ibi.mean
aoc <- within(aoc, {b.ibi.lag = ave(b.ibi.wc, dyad, partner, suprole2, FUN = dplyr::lag)})
aoc<- within(aoc, {b.hr.mean = ave(b.hr, dyad, partner, FUN = mean.na)})
aoc$b.hr.wc <- aoc$b.hr - aoc$b.hr.mean
aoc <- within(aoc, {b.hr.lag = ave(b.hr.wc, dyad, partner, suprole2, FUN = dplyr::lag)})
aoc<- within(aoc, {hr.mean = ave(hr, dyad, partner, FUN = mean.na)})
aoc$hr.wc <- aoc$hr - aoc$hr.mean
aoc <- within(aoc, {hr.lag = ave(hr.wc, dyad, partner, suprole2, FUN = dplyr::lag)})
aoc<- within(aoc, {ibi.phasemean = ave(ibi, dyad, partner, phase, FUN = mean.na)})
#aoc$ibi.basemean <- ifelse(aoc$phase=="GoalDisc", aoc$ibi.phasemean[aoc$time==1], aoc$ibi.phasemean[aoc$time==1])
aoc <- within(aoc, {b.hr.lag = ave(b.hr.wc, dyad, partner, suprole2, FUN = dplyr::lag)})
aoc <- within(aoc, {rsa.basec.lag = ave(rsa.basec, dyad, partner, suprole2, FUN = dplyr::lag)})
aoc <- within(aoc, {b.rsa.basec.lag = ave(b.rsa.basec, dyad, partner, suprole2, FUN = dplyr::lag)})
#View(cbind(aoc$dyad, aoc$partner, aoc$phase, aoc$ibi.phasemean, aoc$ibi.basemean))
aoc$prov <- ifelse(aoc$suprole=="provide", 0, 1)
modelprovwc.brms2 <- brm(b.rsa.wc ~ 0 + pa + pb + pa:rsa.lag + pb:rsa.lag + pa:suprole2 + pb:suprole2 +
+ pa:b.rsa.lag + pb:b.rsa.lag + pa:rsa.lag:suprole2 + pb:rsa.lag:suprole2 +
pa:b.rsa.lag:suprole2 + pb:b.rsa.lag:suprole2 +
(0 + pa + pb + pa:rsa.lag + pb:rsa.lag | dyad), data = aoc, cores = 4,
chains = 1, iter =500, autocor = cor_ar(~time|id))
summary(modelprovwc.brms2)
modelprovwc.brms2 <- brm(b.rsa.wc ~ 0 + pa + pb + pa:rsa.lag + pb:rsa.lag + pa:suprole2 + pb:suprole2 +
+ pa:b.rsa.lag + pb:b.rsa.lag + pa:rsa.lag:suprole2 + pb:rsa.lag:suprole2 +
(0 + pa + pb + pa:rsa.lag + pb:rsa.lag | dyad), data = aoc, cores = 4,
chains = 1, iter =5000, autocor = cor_ar(~time|id))
summary(modelprovwc.brms2)
plot(marginal_effects(modelprovwc.brms2))
## TEMP data.
setwd("/Users/zeekatherine/Desktop/R Files/sseom")
rcc <- read.csv("RCC_DataEntry_ Aggregated_170220_TEMP.csv")
# rel length
rcc2  <-  subset(rcc, relyears < 100)
mean(rcc2$relyears)
sd(rcc2$relyears)
rcc3  <-  subset(rcc, age > 15)
mean(rcc3$age, na.rm=T)
sd(rcc3$age, na.rm=T)
# Responsiveness
rcc$resp.all.m <- with(rcc, cbind(resp1, resp2, resp3))
rcc$resp.all.v <- rowMeans(rcc$resp.all.m, na.rm=T)
rcc$resp.all.c <- center(rcc$resp.all.v)
rcc$presp.all.m <- with(rcc, cbind(presp1, presp2, presp3))
rcc$presp.all.v <- rowMeans(rcc$presp.all.m, na.rm=T)
rcc$presp.all.c <- center(rcc$presp.all.v)
# RESS
rcc$truth.m <- with(rcc, cbind(rt1, rt2, rt3))
rcc$truth.v <- rowMeans(rcc$truth.m)
rcc$truth.c <- center(rcc$truth.v)
rcc$control.m <- with(rcc, cbind(rc1, rc2, rc3))
rcc$control.v <- rowMeans(rcc$control.m)
rcc$control.c <- center(rcc$control.v)
rcc$value.m <- with(rcc, cbind(rv1, rv2, rv3))
rcc$value.v <- rowMeans(rcc$value.m)
rcc$value.c <- center(rcc$value.v)
rcc$ress.m <- with(rcc, cbind(truth.v, control.v, value.v))
psych::alpha(rcc$ress.m )
rcc$ress.v <- rowMeans(rcc$ress.m)
rcc$ress.c <- center(rcc$ress.v)
rcc$ptruth.m <- with(rcc, cbind(pt1, pt2, pt3))
rcc$ptruth.v <- rowMeans(rcc$ptruth.m)
rcc$pcontrol.m <- with(rcc, cbind(pc1, pc2, pc3))
rcc$pcontrol.v <- rowMeans(rcc$pcontrol.m)
rcc$pv1r <- ifelse(rcc$pv1 > 7, 7, rcc$pv1)
rcc$pvalue.m <- with(rcc, cbind(pv1r, pv2, pv3))
rcc$pvalue.v <- rowMeans(rcc$pvalue.m)
rcc$press.m <- with(rcc, cbind(ptruth.v, pcontrol.v, pvalue.v))
rcc$press.v <- rowMeans(rcc$press.m)
rcc$press.c <- center(rcc$press.v)
# Baseline Mood
#rcc$baseneg.m <- with(rcc, cbind(issuemood1, issuemood2, issuemood5, issuemood6, issuemood7))
rcc$baseneg.m <- with(rcc, cbind(issuemood5, issuemood6))
rcc$baseneg.v <- rowMeans(rcc$baseneg.m, na.rm=T)
rcc$baseneg.c <- center(rcc$baseneg.v)
rcc$basepos.m <- with(rcc, cbind(issuemood3, issuemood4, issuemood8, issuemood9))
rcc$basepos.v <- rowMeans(rcc$basepos.m, na.rm=T)
rcc$basepos.c <- center(rcc$basepos.v)
# Post-Support Mood
#rcc$postneg.m <- with(rcc, cbind(nowmood1, nowmood2, nowmood5, nowmood6, nowmood7))
rcc$postneg.m <- with(rcc, cbind(nowmood5, nowmood6))
psych::alpha(rcc$postneg.m, na.rm=T)
rcc$postneg.v <- rowMeans(rcc$postneg.m, na.rm=T)
rcc$postpos.m <- with(rcc, cbind(nowmood3, nowmood4, nowmood8, nowmood9))
rcc$postpos.v <- rowMeans(rcc$postpos.m, na.rm=T)
psych::alpha(rcc$postpos.m, na.rm=T)
# Mood During Support Interaction
#rcc$supneg.m <- with(rcc, cbind(supmood1, supmood2, supmood5, supmood6, supmood7))
rcc$supneg.m <- with(rcc, cbind(supmood5, supmood6))
psych::alpha(rcc$supneg.m, na.rm=T)
rcc$supneg.v <- rowMeans(rcc$supneg.m, na.rm=T)
rcc$suppos.m <- with(rcc, cbind(supmood3, supmood4, supmood8, supmood9))
rcc$suppos.v <- rowMeans(rcc$suppos.m, na.rm=T)
psych::alpha(rcc$suppos.m, na.rm=T)
# closeness
rcc$close <- rcc$eff6
rcc$ios
# supquant
rcc$remo.c <- rcc$remo
rcc$rprac.c <- rcc$rprac
rcc$pemo.c <- rcc$pemo
rcc$pprac.c <- rcc$pprac
# support effectiveness
rcc$supeff.m <- with(rcc, cbind(eff1, eff2))
rcc$supeff.v <- rowMeans(rcc$supeff.m, na.rm =T)
rcc$relyears
sort(rcc3$age)
mean(rcc3$age, na.rm=T)
rcc3a <- subset(rcc3, relyears < 50)
rcc3a$age
rcc3a$relyears
rcc3$age
rcc3  <-  subset(rcc, age > 15)
mean(rcc3$age, na.rm=T)
sd(rcc3$age, na.rm=T)
rcc3a <- subset(rcc3, relyears < 500)
rcc3a$age
summary(lmer(ios ~ age + relyears + (1 | dyad), data = rcc3))
rcc$resp.all.m <- with(rcc, cbind(resp1, resp2, resp3))
rcc$resp.all.v <- rowMeans(rcc$resp.all.m, na.rm=T)
rcc$resp.all.c <- center(rcc$resp.all.v)
rcc$presp.all.m <- with(rcc, cbind(presp1, presp2, presp3))
rcc$presp.all.v <- rowMeans(rcc$presp.all.m, na.rm=T)
rcc$presp.all.c <- center(rcc$presp.all.v)
# RESS
rcc$truth.m <- with(rcc, cbind(rt1, rt2, rt3))
rcc$truth.v <- rowMeans(rcc$truth.m)
rcc$truth.c <- center(rcc$truth.v)
rcc$control.m <- with(rcc, cbind(rc1, rc2, rc3))
rcc$control.v <- rowMeans(rcc$control.m)
rcc$control.c <- center(rcc$control.v)
rcc$value.m <- with(rcc, cbind(rv1, rv2, rv3))
rcc$value.v <- rowMeans(rcc$value.m)
rcc$value.c <- center(rcc$value.v)
rcc$ress.m <- with(rcc, cbind(truth.v, control.v, value.v))
psych::alpha(rcc$ress.m )
rcc$ress.v <- rowMeans(rcc$ress.m)
rcc$ress.c <- center(rcc$ress.v)
rcc$ptruth.m <- with(rcc, cbind(pt1, pt2, pt3))
rcc$ptruth.v <- rowMeans(rcc$ptruth.m)
rcc$pcontrol.m <- with(rcc, cbind(pc1, pc2, pc3))
rcc$pcontrol.v <- rowMeans(rcc$pcontrol.m)
rcc$pv1r <- ifelse(rcc$pv1 > 7, 7, rcc$pv1)
rcc$pvalue.m <- with(rcc, cbind(pv1r, pv2, pv3))
rcc$pvalue.v <- rowMeans(rcc$pvalue.m)
rcc$press.m <- with(rcc, cbind(ptruth.v, pcontrol.v, pvalue.v))
rcc$press.v <- rowMeans(rcc$press.m)
rcc$press.c <- center(rcc$press.v)
# Baseline Mood
#rcc$baseneg.m <- with(rcc, cbind(issuemood1, issuemood2, issuemood5, issuemood6, issuemood7))
rcc$baseneg.m <- with(rcc, cbind(issuemood5, issuemood6))
rcc$baseneg.v <- rowMeans(rcc$baseneg.m, na.rm=T)
rcc$baseneg.c <- center(rcc$baseneg.v)
rcc$basepos.m <- with(rcc, cbind(issuemood3, issuemood4, issuemood8, issuemood9))
rcc$basepos.v <- rowMeans(rcc$basepos.m, na.rm=T)
rcc$basepos.c <- center(rcc$basepos.v)
# Post-Support Mood
#rcc$postneg.m <- with(rcc, cbind(nowmood1, nowmood2, nowmood5, nowmood6, nowmood7))
rcc$postneg.m <- with(rcc, cbind(nowmood5, nowmood6))
psych::alpha(rcc$postneg.m, na.rm=T)
rcc$postneg.v <- rowMeans(rcc$postneg.m, na.rm=T)
rcc$postpos.m <- with(rcc, cbind(nowmood3, nowmood4, nowmood8, nowmood9))
rcc$postpos.v <- rowMeans(rcc$postpos.m, na.rm=T)
psych::alpha(rcc$postpos.m, na.rm=T)
# Mood During Support Interaction
#rcc$supneg.m <- with(rcc, cbind(supmood1, supmood2, supmood5, supmood6, supmood7))
rcc$supneg.m <- with(rcc, cbind(supmood5, supmood6))
psych::alpha(rcc$supneg.m, na.rm=T)
rcc$supneg.v <- rowMeans(rcc$supneg.m, na.rm=T)
rcc$suppos.m <- with(rcc, cbind(supmood3, supmood4, supmood8, supmood9))
rcc$suppos.v <- rowMeans(rcc$suppos.m, na.rm=T)
psych::alpha(rcc$suppos.m, na.rm=T)
# closeness
rcc$close <- rcc$eff6
rcc$ios
# supquant
rcc$remo.c <- rcc$remo
rcc$rprac.c <- rcc$rprac
rcc$pemo.c <- rcc$pemo
rcc$pprac.c <- rcc$pprac
summary(lmer(ios ~ age + relyears + close + (1 | dyad), data = rcc3))
summary(lmer(ios ~ age + relyears + supeff.v + (1 | dyad), data = rcc3))
rcc3a$supeff.c <- center(rcc3a$supeff.v)
rcc3a$age.c <- center(rcc3a$age)
summary(lmer(ios ~ age.c*supeff.c + relyears + (1 | dyad), data = rcc3))
rcc3a$age.c <- center(rcc3a$age)
summary(lmer(ios ~ age.c*supeff.c + relyears + (1 | dyad), data = rcc3))
summary(lmer(ios ~ age.c*supeff.c + relyears + (1 | dyad), data = rcc3a))
summary(lmer(ios ~ age.c+ supeff.c + relyears + (1 | dyad), data = rcc3a))
summary(lmer(supeff.v ~ age + relyears + (1 | dyad), data = rcc3a))
rcc3a$age.eff <- ifelse(rcc3a$age < 40, -.5, .5)
summary(lmer(supeff.v ~ age.eff + relyears + (1 | dyad), data = rcc3a))
summary(lmer(supeff.v ~ age.eff  + (1 | dyad), data = rcc3a))
summary(lmer(ios ~ age.eff + relyears + (1 | dyad), data = rcc3a))
sort(rcc3a$age)
library(irr)
rvid <- read.csv("/Users/zeekatherine/Desktop/R Files/RCC_Data/RCC Video Coding/RCC Video Coding 170307.csv")
r.negmoodcode <- cbind(rvid$s.rnegmood, rvid$j.rnegmood)
icc(r.negmoodcode, "twoway")
p.negmoodcode <- cbind(rvid$s.pnegmood, rvid$j.pnegmood)
icc(p.negmoodcode, "twoway")
r.posmoodcode <- cbind(rvid$s.rposmood, rvid$j.rposmood)
icc(r.posmoodcode, "twoway")
p.posmoodcode <- cbind(rvid$s.pposmood, rvid$j.pposmood)
icc(p.posmoodcode, "twoway")
r.laugh <- cbind(rvid$s.rlaugh, rvid$j.rlaugh)
icc(r.laugh, "twoway")
p.laugh <- cbind(rvid$s.plaugh, rvid$j.plaugh)
icc(p.laugh, "twoway") # only .5
supqt <- cbind(rvid$s.supqt, rvid$j.subqty)
icc(supqt, "twoway")
suppos<- cbind(rvid$s.suppos, rvid$j.suppos)
icc(suppos, "twoway")
supneg<- cbind(rvid$s.supneg, rvid$j.supneg)
icc(supneg, "twoway")
emosup<- cbind(rvid$s.emo, rvid$j.emo)
icc(emosup, "twoway") #### only .46 ICC
pracsup<- cbind(rvid$s.prac, rvid$j.prac)
icc(pracsup, "twoway")
save.image("~/Desktop/R Files/RCC_Data/rcc_physio_AOC_170307.RData")
q()
